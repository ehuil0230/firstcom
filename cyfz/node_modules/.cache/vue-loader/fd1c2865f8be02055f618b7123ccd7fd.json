{"remainingRequest":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vueWorkspace\\cyfz\\src\\views\\xtgl\\menuPage\\sprgl.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vueWorkspace\\cyfz\\src\\views\\xtgl\\menuPage\\sprgl.vue","mtime":1571715213008},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport TableList from \"../../../components/grid/TableList\";\nimport OrgTree from \"../myToolbar/OrgTree\";\n\nexport default {\n    name: \"sprgl\",\n    components: {\n        TableList,\n        OrgTree\n    },\n    data() {\n        return {\n            show2: true,\n            orgTreeObj: {\n                leftTreeProps: {// 左侧树props\n                    label: 'name',\n                    children: 'children'\n                },\n                daixuanTreeProps: {// 待选树props\n                    label: 'realName'\n                },\n                orgTree: [],\n                daixuanData: [],\n                type: ''\n            },\n            provinceNames: [],\n            provinceName: '',\n            approverNames: [],\n            dialogFormVisible: false,\n            checkedData: [], //全选框\n            //分页\n            pagination: {\n                currentPage: 1,\n                pageSize: 10,\n                position: 'center',\n                pageSizes: [10, 50, 100],//默认每页显示多少条\n                layout: 'sizes ,prev, pager, next, jumper'\n            },\n            //表单字段\n            columns: [\n                {\n                    label: '审批人',\n                    prop: 'approverName',\n\n                },\n                {\n                    label: '审批类型',\n                    prop: 'approverTypeName',\n\n                },\n                {\n                    label: '所属省份',\n                    prop: 'provinceName',\n                }\n\n            ],\n            //调用组件传输返回页面数据\n            getDataWay: {\n                dataType: \"url\",\n                data: this.$api.xtglApi.queryApproveUser,\n                type: \"post\",\n                param: {},\n            },\n            spForm: {\n                approverid: '',\n                approverName: '',\n                approverTypeName: '',\n                provinceName: ''\n            }\n        }\n    },\n    methods: {\n        //审批人选中时\n        spCheckedChange(data) {\n            this.spForm.approverName = data.realName;\n            this.spForm.approverid = data.uuid;\n        },\n        openOrg() {\n            this.show2 = !this.show2;\n        },\n        nodeClick(data) {\n            this.spForm.approverName = data.realName;\n            this.spForm.approverid = data.uuid;\n        },\n        saveForm() {\n            var that = this\n            this.$$request({\n                url: this.$api.xtglApi.updateApproveUser,\n                data: {uuid: this.checkedData[0].uuid, approverid: this.spForm.approverid}\n            }).then(function (res) {\n                if (res.result == 1) {\n                    that.dialogFormVisible = false;\n                    that.$refs.table.loadData();\n                    that.$message({type: 'success', message: '修改成功'})\n                }\n            }).catch(\n                function () {\n                    that.$message({type: 'error', message: '修改失败'})\n                }\n            )\n        },\n        search() {\n            this.$set(this.getDataWay.param, 'provinceDm', this.provinceName);\n            this.$refs.table.loadData();\n        },\n        //页面刷新\n        refreshTable(refresh) {\n            this.checkedData = [];\n            this.$refs.table.loadData()\n        },\n        handleClose() {\n            this.checkedData = [];\n            this.$refs.table.loadData()\n            this.orgTreeObj.daixuanData = []\n            this.dialogFormVisible = false;\n\n        },\n        openXG() {\n            if (this.checkedData.length === 1) {\n                this.dialogFormVisible = true\n                this.$set(this.spForm, 'approverid', this.checkedData[0].approverid);\n                this.$set(this.spForm, 'approverName', this.checkedData[0].approverName);\n                let that = this\n                this.$$request({\n                    url: this.$api.homeApi.getListAllOrgTree,\n                    data: {}\n                }).then(function (res) {\n                    if (res.result === 1) {\n                        that.orgTreeObj.orgTree = res.info\n                    }\n                })\n\n                this.spForm.approverTypeName = this.checkedData[0].approverTypeName;\n                this.spForm.provinceName = this.checkedData[0].provinceName;\n            } else {\n                this.$message({type: 'warning', message: '请选择一条数据'})\n            }\n        }\n    },\n    created() {\n        var that = this\n        // 请求省份码表\n        this.$$request({\n            url: this.$api.getCodeData,\n            data: {\n                tableName: \"DM_PROVINCE\"\n            }\n        }).then(function (res) {\n            if (res.result === 1) {\n                that.provinceNames = res.info;\n            } else {\n                this.$message({type: 'error', message: '系统异常，请联系管理员！'})\n                return false\n            }\n        }).catch(function () {\n            this.$message({type: 'error', message: '系统异常，请联系管理员！'})\n            return false\n        })\n    },\n}\n\n\n",{"version":3,"sources":["sprgl.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"sprgl.vue","sourceRoot":"src/views/xtgl/menuPage","sourcesContent":["<template>\r\n    <div class=\"rightMain\">\r\n        <el-form :inline=\"true\" size=\"small\">\r\n            <div class=\"task-btn-item\">\r\n                <el-button @click=\"openXG\" size=\"small\" type=\"primary\">修改</el-button>\r\n                <el-button size=\"small\" type=\"primary\" @click=\"refreshTable\">刷新</el-button>\r\n            </div>\r\n            <div class=\"task-form-item\">\r\n                <el-form-item label=\"所属省份\">\r\n                    <el-select v-model=\"provinceName\" clearable placeholder=\"请选择\">\r\n                        <el-option\r\n                                v-for=\"item in provinceNames\"\r\n                                :key=\"item.CODE\"\r\n                                :label=\"item.CAPTION\"\r\n                                :value=\"item.CODE\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-button @click=\"search\" size=\"small\" style=\"margin-left: 10px\" type=\"primary\">搜索</el-button>\r\n            </div>\r\n\r\n        </el-form>\r\n        <tableList ref=\"table\"\r\n                   selection\r\n                   index\r\n                   style=\"border-top: none;text-align: center\"\r\n                   :getDataWay=\"getDataWay\"\r\n                   :columns=\"columns\"\r\n                   :pagination=\"pagination\"\r\n                   :checkedData='checkedData'\r\n        >\r\n        </tableList>\r\n        <el-dialog\r\n                :close-on-click-modal=false\r\n                title=\"修改审批人\"\r\n                :visible.sync=\"dialogFormVisible\"\r\n                v-dialogDrag\r\n                @close=\"handleClose\">\r\n            <div class=\"el-dialog-div\">\r\n                <el-form :model=\"spForm\" ref=\"spForm\" label-width=\"90px\"\r\n                         class=\"demo-ruleForm\">\r\n                    <el-form-item label=\"审批人\" prop=\"approverName\">\r\n                        <!--<el-select v-model=\"spForm.approverid\" placeholder=\"请选择\">\r\n                            <el-option\r\n                                    v-for=\"item in approverNames\"\r\n                                    :key=\"item.uuid\"\r\n                                    :label=\"item.realName\"\r\n                                    :value=\"item.uuid\">\r\n                            </el-option>\r\n                        </el-select>-->\r\n                        <el-input v-model=\"spForm.approverName\" disabled=\"disabled\">\r\n                            <el-button slot=\"append\" icon=\"el-icon-folder-opened\"\r\n                                       @click=\"openOrg\"></el-button>\r\n                        </el-input>\r\n                        <transition name=\"el-zoom-in-top\">\r\n                            <div v-show=\"show2\" class=\"transition-box\">\r\n                                <org-tree @nodeClick=\"nodeClick\" @spCheckedChange=\"spCheckedChange\"\r\n                                          :org-tree-obj=\"orgTreeObj\"></org-tree>\r\n                            </div>\r\n                        </transition>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"审批类型\" prop=\"approverTypeName\">\r\n                        <el-input v-model=\"spForm.approverTypeName\" disabled=\"disabled\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"所属省份\" prop=\"provinceName\">\r\n                        <el-input v-model=\"spForm.provinceName\" disabled=\"disabled\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item style=\"padding-left: 35%\">\r\n                        <el-button type=\"primary\" @click=\"saveForm()\">保存</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n\r\n            </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n<script>\r\n    import TableList from \"../../../components/grid/TableList\";\r\n    import OrgTree from \"../myToolbar/OrgTree\";\r\n\r\n    export default {\r\n        name: \"sprgl\",\r\n        components: {\r\n            TableList,\r\n            OrgTree\r\n        },\r\n        data() {\r\n            return {\r\n                show2: true,\r\n                orgTreeObj: {\r\n                    leftTreeProps: {// 左侧树props\r\n                        label: 'name',\r\n                        children: 'children'\r\n                    },\r\n                    daixuanTreeProps: {// 待选树props\r\n                        label: 'realName'\r\n                    },\r\n                    orgTree: [],\r\n                    daixuanData: [],\r\n                    type: ''\r\n                },\r\n                provinceNames: [],\r\n                provinceName: '',\r\n                approverNames: [],\r\n                dialogFormVisible: false,\r\n                checkedData: [], //全选框\r\n                //分页\r\n                pagination: {\r\n                    currentPage: 1,\r\n                    pageSize: 10,\r\n                    position: 'center',\r\n                    pageSizes: [10, 50, 100],//默认每页显示多少条\r\n                    layout: 'sizes ,prev, pager, next, jumper'\r\n                },\r\n                //表单字段\r\n                columns: [\r\n                    {\r\n                        label: '审批人',\r\n                        prop: 'approverName',\r\n\r\n                    },\r\n                    {\r\n                        label: '审批类型',\r\n                        prop: 'approverTypeName',\r\n\r\n                    },\r\n                    {\r\n                        label: '所属省份',\r\n                        prop: 'provinceName',\r\n                    }\r\n\r\n                ],\r\n                //调用组件传输返回页面数据\r\n                getDataWay: {\r\n                    dataType: \"url\",\r\n                    data: this.$api.xtglApi.queryApproveUser,\r\n                    type: \"post\",\r\n                    param: {},\r\n                },\r\n                spForm: {\r\n                    approverid: '',\r\n                    approverName: '',\r\n                    approverTypeName: '',\r\n                    provinceName: ''\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            //审批人选中时\r\n            spCheckedChange(data) {\r\n                this.spForm.approverName = data.realName;\r\n                this.spForm.approverid = data.uuid;\r\n            },\r\n            openOrg() {\r\n                this.show2 = !this.show2;\r\n            },\r\n            nodeClick(data) {\r\n                this.spForm.approverName = data.realName;\r\n                this.spForm.approverid = data.uuid;\r\n            },\r\n            saveForm() {\r\n                var that = this\r\n                this.$$request({\r\n                    url: this.$api.xtglApi.updateApproveUser,\r\n                    data: {uuid: this.checkedData[0].uuid, approverid: this.spForm.approverid}\r\n                }).then(function (res) {\r\n                    if (res.result == 1) {\r\n                        that.dialogFormVisible = false;\r\n                        that.$refs.table.loadData();\r\n                        that.$message({type: 'success', message: '修改成功'})\r\n                    }\r\n                }).catch(\r\n                    function () {\r\n                        that.$message({type: 'error', message: '修改失败'})\r\n                    }\r\n                )\r\n            },\r\n            search() {\r\n                this.$set(this.getDataWay.param, 'provinceDm', this.provinceName);\r\n                this.$refs.table.loadData();\r\n            },\r\n            //页面刷新\r\n            refreshTable(refresh) {\r\n                this.checkedData = [];\r\n                this.$refs.table.loadData()\r\n            },\r\n            handleClose() {\r\n                this.checkedData = [];\r\n                this.$refs.table.loadData()\r\n                this.orgTreeObj.daixuanData = []\r\n                this.dialogFormVisible = false;\r\n\r\n            },\r\n            openXG() {\r\n                if (this.checkedData.length === 1) {\r\n                    this.dialogFormVisible = true\r\n                    this.$set(this.spForm, 'approverid', this.checkedData[0].approverid);\r\n                    this.$set(this.spForm, 'approverName', this.checkedData[0].approverName);\r\n                    let that = this\r\n                    this.$$request({\r\n                        url: this.$api.homeApi.getListAllOrgTree,\r\n                        data: {}\r\n                    }).then(function (res) {\r\n                        if (res.result === 1) {\r\n                            that.orgTreeObj.orgTree = res.info\r\n                        }\r\n                    })\r\n\r\n                    this.spForm.approverTypeName = this.checkedData[0].approverTypeName;\r\n                    this.spForm.provinceName = this.checkedData[0].provinceName;\r\n                } else {\r\n                    this.$message({type: 'warning', message: '请选择一条数据'})\r\n                }\r\n            }\r\n        },\r\n        created() {\r\n            var that = this\r\n            // 请求省份码表\r\n            this.$$request({\r\n                url: this.$api.getCodeData,\r\n                data: {\r\n                    tableName: \"DM_PROVINCE\"\r\n                }\r\n            }).then(function (res) {\r\n                if (res.result === 1) {\r\n                    that.provinceNames = res.info;\r\n                } else {\r\n                    this.$message({type: 'error', message: '系统异常，请联系管理员！'})\r\n                    return false\r\n                }\r\n            }).catch(function () {\r\n                this.$message({type: 'error', message: '系统异常，请联系管理员！'})\r\n                return false\r\n            })\r\n        },\r\n    }\r\n\r\n\r\n</script>\r\n<style scoped lang=\"less\">\r\n\r\n    .rightMain {\r\n        margin: 10px auto;\r\n        width: 93%;\r\n        /*margin-right: 90px;\r\n        align:0 auto;\r\n        padding-left: 10px;\r\n        padding-top: 20px;\r\n        min-width: 150px;*/\r\n    }\r\n\r\n    .task-form-item {\r\n        margin-left: 359px;\r\n        display: inline-block;\r\n        vertical-align: middle;\r\n    }\r\n\r\n    .task-btn-item {\r\n        padding-top: 0;\r\n        display: inline-block;\r\n        margin-left: 0px;\r\n        vertical-align: middle;\r\n        float: left;\r\n        padding-left: 10px;\r\n    }\r\n</style>"]}]}