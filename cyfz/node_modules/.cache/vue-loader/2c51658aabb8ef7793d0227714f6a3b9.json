{"remainingRequest":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vueWorkspace\\cyfz\\src\\views\\demo\\wps\\wpsLinux.vue?vue&type=style&index=0&id=93b802de&scoped=true&lang=css&","dependencies":[{"path":"D:\\vueWorkspace\\cyfz\\src\\views\\demo\\wps\\wpsLinux.vue","mtime":1568987312146},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.doc-wps {\n    width: 95%;\n    margin: 10px auto;\n    min-height: 600px;\n    background-color: beige;\n}\n\n",{"version":3,"sources":["wpsLinux.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgLA;AACA;AACA;AACA;AACA;AACA","file":"wpsLinux.vue","sourceRoot":"src/views/demo/wps","sourcesContent":["<template>\r\n    <div id=\"wpsTool\">\r\n        <el-container>\r\n            <el-header>\r\n                <el-row>\r\n                    <el-button @click=\"InitFrame()\" plain>初始化插件</el-button>\r\n                    <el-button @click=\"createDocument()\" type=\"success\" plain>新建</el-button>\r\n                    <el-button @click=\"openDocumentRemote()\" type=\"primary\" plain>打开文档</el-button>\r\n                    <el-button @click=\"setField()\" type=\"warning\" plain>填充公文域</el-button>\r\n                    <el-button @click=\"saveURL()\" type=\"success\" plain>保存</el-button>\r\n                    <el-button @click=\"printwps()\" type=\"info\" plain>打印</el-button>\r\n                    <el-button @click=\"closewps()\" type=\"danger\" plain>关闭文档</el-button>\r\n                    <el-button @click=\"closePage()\" type=\"danger\" plain>关闭页面</el-button>\r\n                </el-row>\r\n            </el-header>\r\n            <el-main>\r\n                <div id=\"docDiv\" align=\"right\" style=\"width:90%; height:600px; background-color: beige\"></div>\r\n            </el-main>\r\n        </el-container>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    var ie = !!window.ActiveXObject || \"ActiveXObject\" in window; //edge为false,ie11为true\r\n    var obj = null;\r\n    var app = null;\r\n\r\n    function init(ext, objH, objW) {\r\n        var iframe = document.getElementById('docDiv');\r\n        var _obj = null;\r\n        var html = '';\r\n        if (ext == \"et\") {\r\n            if (ie) {\r\n                var codes = [];\r\n                codes.push('<object id=DocFrame height=' + objH + ' width=' + objW + ' ');\r\n                codes.push('data=data:application/x-oleobject;base64,7Kd9juwHQ0OBQYiirbY6XwEABAA7DwMAAgAEAB0AAAADAAQAgICAAAQABAD///8ABQBcAFgAAABLAGkAbgBnAHMAbwBmAHQAIABBAGMAdABpAHYAZQBYACAARABvAGMAdQBtAGUAbgB0ACAARgByAGEAbQBlACAAQwBvAG4AdAByAG8AbAAgADEALgAwAAAA ');\r\n                codes.push('classid=clsid:8E7DA7EC-07EC-4343-8141-88A2ADB63A5F viewastext=VIEWASTEXT></object> ');\r\n                html = codes.join(\"\");\r\n            } else {\r\n                var codes = [];\r\n                codes.push(\"<object  name='webet' id=DocFrame type='application/x-et' data='../dzgw/zhengwen/editor/wps/normal.et'  width='\" + objW + \"'  height='\" + objH + \"'>\");\r\n                codes.push('<param name=\"quality\" value=\"high\" />');\r\n                codes.push('<param name=\"bgcolor\" value=\"#ffffff\" />');\r\n                codes.push('<param name=\"Enabled\" value=\"1\" />');\r\n                codes.push('<param name=\"allowFullScreen\" value=\"true\" />');\r\n                codes.push('</object>');\r\n                html = codes.join(\"\");\r\n            }\r\n        } else {\r\n            if (ie) {\r\n                var codes = [];\r\n                codes.push('<object id=DocFrame height=' + objH + ' width=' + objW + ' ');\r\n                codes.push('data=data:application/x-oleobject;base64,7Kd9juwHQ0OBQYiirbY6XwEABAA7DwMAAgAEAB0AAAADAAQAgICAAAQABAD///8ABQBcAFgAAABLAGkAbgBnAHMAbwBmAHQAIABBAGMAdABpAHYAZQBYACAARABvAGMAdQBtAGUAbgB0ACAARgByAGEAbQBlACAAQwBvAG4AdAByAG8AbAAgADEALgAwAAAA ');\r\n                codes.push('classid=clsid:8E7DA7EC-07EC-4343-8141-88A2ADB63A5F viewastext=VIEWASTEXT></object> ');\r\n                html = codes.join(\"\");\r\n            } else {\r\n                html = \"<object  name='webwps' id='DocFrame' type='application/x-wps'  data='/opt/kingsoft/wps-office/office6/mui/default/templates/Normal.dotm'  width='\" + objW + \"'  height='\" + objH + \"'> <param name='Enabled' value='1' />  </object>\";\r\n            }\r\n        }\r\n        iframe.innerHTML = html;\r\n        _obj = document.getElementById('DocFrame');\r\n        if (!ie && _obj) {\r\n            if (!_obj) {\r\n                alert('加载流式金山出错!');\r\n            }\r\n            window.onbeforeunload = function () {\r\n                _obj.Application.Quit();\r\n            };\r\n            window.onresize = function () {\r\n                _obj.sltReleaseKeyboard();\r\n            };\r\n        }\r\n        return _obj;\r\n    }\r\n\r\n    function initF(fromUrl) {\r\n        obj = init(\"wps\", \"100%\", \"100%\");\r\n        if (!ie && obj) {\r\n            var Interval_control = setInterval(function () {\r\n                app = obj.Application;\r\n                if (app && app.IsLoad()) {\r\n                    clearInterval(Interval_control);\r\n                    app.openDocumentRemote(fromUrl, false)\r\n                }\r\n            }, 500);\r\n        } else {\r\n            app = obj;\r\n            app.openDocumentRemote(fromUrl, false)\r\n        }\r\n    }\r\n\r\n    export default {\r\n        name: \"wpsLinux\",\r\n        props: [\"docData\"],\r\n        data() {\r\n            return {\r\n                wpsData: this.docData,\r\n                fromUrl: \"http://10.15.0.111:8085/wps/a.wpt\",\r\n                saveUrl: 'http://10.15.0.111:8085/wps/a.wpt',\r\n                fields: [\r\n                    {key: \"各单位\", value: \"1111\"},\r\n                ]\r\n            }\r\n        },\r\n        mounted() {\r\n            /*初始化页面和打开文件在这写*/\r\n            initF(this.fromUrl);\r\n        },\r\n        methods: {\r\n            InitFrame: function () {\r\n                obj = init(\"wps\", \"100%\", \"100%\");\r\n                if (!ie && obj) {\r\n                    var Interval_control = setInterval(function () {\r\n                        app = obj.Application;\r\n                        if (app && app.IsLoad()) {\r\n                            clearInterval(Interval_control);\r\n                            app.createDocument(\"wps\");\r\n                        }\r\n                    }, 500);\r\n                } else {\r\n                    app = obj;\r\n                }\r\n            },\r\n            createDocument: function () {\r\n                if (ie) {\r\n                    app.createDocument(\"uot\");\r\n                } else {\r\n                    app.createDocument(\"wps\");\r\n                }\r\n            },\r\n            openDocumentRemote: function () {\r\n                app.openDocumentRemote(\"http://10.15.0.111:8085/wps/a.wpt\", false);\r\n            },\r\n            setField() {\r\n                for (let field of this.fields) {\r\n                    app.setDocumentField(field.key, field.value);\r\n                }\r\n            },\r\n            saveURL() {\r\n                app.saveURL(this.saveUrl, \"filename\", function () {\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '保存成功!'\r\n                    });\r\n                    //回调\r\n                });\r\n            },\r\n            printwps: function () {\r\n                app.print();\r\n            },\r\n            closewps: function () {\r\n                app.close();\r\n            },\r\n            closePage: function () {\r\n                this.$confirm('确定要关闭页面?', '关闭', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    this.$router.go(-1);\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '关闭页面!'\r\n                    });\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消'\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .doc-wps {\r\n        width: 95%;\r\n        margin: 10px auto;\r\n        min-height: 600px;\r\n        background-color: beige;\r\n    }\r\n\r\n</style>\r\n"]}]}