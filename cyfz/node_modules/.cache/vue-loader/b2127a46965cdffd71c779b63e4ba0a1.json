{"remainingRequest":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vueWorkspace\\cyfz\\src\\components\\upload\\uploadList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vueWorkspace\\cyfz\\src\\components\\upload\\uploadList.vue","mtime":1569635176328},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport TableList from \"../grid/TableList\";\nexport default {\n    name: \"uploadList\",\n    components:{\n        tableList:TableList,\n    },\n    props:{\n        listColumns:{\n            type:Array,\n            required:true\n        },\n        listData:{\n            type:Array,\n            required:true\n        },\n        listType:{\n            type:String,\n            required:true\n        }\n    },\n    data(){\n        return{\n            getDataWay:{\n                dataType:'data',\n                data:this.listData\n            }\n        }\n    },\n    methods: {\n        handlePreview(index, row){\n            console.log(row);\n            if(this.listType==='picture') {\n                let url = this.$api.upload.reqUrl+ this.$api.upload.downloadByMd5Path+\"?md5Path=\"+row.md5Path+ \"&access_token=\"+localStorage.getItem(\"Authorization\").split(\" \")[1]\n                // let url = this.$api.upload.reqUrl + this.$api.upload.preview + '?md5Path='+row.md5Path;\n                window.open(url, '_blank')\n                this.$message({\n                    type:\"success\",\n                    message:'图片预览'\n                })\n            }else {\n                if (row.md5Path) {\n                    let fileExt = row.fileSrcName.split('.')[1];\n                    let that = this;\n                    console.log(fileExt)\n                    let url = that.$api.upload.reqUrl + that.$api.upload.preview + '?md5Path='\n                    if (fileExt === 'pdf') {\n                        let param = row.md5Path + '&waterMark=1&forceRefresh=1&access_token=' + localStorage.getItem('access_token')\n                        window.open(url + param, '_blank')\n                    } else {//非pdf文件预览还在解决\n                        that.$message({\n                            type: 'info',\n                            message: '预览失败，目前仅支持pdf类型文件预览！'\n                        })\n                    }\n                } else {\n                    this.$message({\n                        type: 'info',\n                        message: '预览失败，请检查文件路径！'\n                    })\n                }\n            }\n        },\n        handleDownload(index, row) {//上传文件可下载\n            console.log(index);\n            console.log(row);\n            let that = this;\n            this.$$download(row).then(()=>{\n                that.$message({\n                    type: 'success',\n                    message: '下载成功！'\n                })\n            }).catch((err)=>{\n                that.$message({\n                    type: 'info',\n                    message: '下载失败！'\n                })\n            })\n        },\n        handleDown(index, row) {//下移\n            console.log(index);\n            console.log(row);\n            if(index===this.getDataWay.data.length-1){\n                this.$message({\n                    type:\"warning\",\n                    duration:1000,\n                    message:\"已经到底了\"\n                })\n                return false\n            }else {\n                let item = this.getDataWay.data[index];\n                this.$set(this.getDataWay.data,index,this.getDataWay.data[index+1])\n                this.$set(this.getDataWay.data,index+1,item)\n            }\n            console.log(this.getDataWay.data);\n        },\n        handleUp(index, row) {//上移\n            console.log(index);\n            console.log(row);\n            if(index===0){\n                this.$message({\n                    type:\"warning\",\n                    duration:1000,\n                    message:\"已经到顶了\"\n                })\n                return false\n            }else {\n                let item = this.getDataWay.data[index];\n                this.$set(this.getDataWay.data,index,this.getDataWay.data[index-1])\n                this.$set(this.getDataWay.data,index-1,item)\n            }\n            console.log(this.getDataWay.data);\n        },\n        handleDelete(index, row) {//删除\n            console.log(index);\n            console.log(row);\n            let that = this;\n            this.$confirm(`确定移除该文件？`, '提示', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                console.log('------',row);\n                that.$$deleteUpLoad({md5Path:row.md5Path}).then((res)=>{\n                    that.$message({\n                        type: 'success',\n                        message: '删除成功'\n                    });\n                    that.getDataWay.data.splice(index, 1);\n                }).catch((err)=>{\n                    that.$message({\n                        type: 'warning',\n                        message: '删除失败'\n                    })\n                })\n                /*that.$axios({\n                    method: 'post',\n                    url: this.$api.wjglApi.Zh001deleteFile,\n                    data: {\n                        id: row.id,\n                    }\n                }).then(function (response) {\n                    console.log(response,'//////');\n                    that.$message({\n                        type: 'warning',\n                        message: '删除成功'\n                    });\n                    that.tableData.splice(index, 1);\n                    if(!!row.filePath){\n                        that.$emit('delFile',row)\n                    }\n                }).catch(function (error) {\n                    console.log('>>>>>>>');\n                    that.$message({\n                        type: 'warning',\n                        message: '删除失败'\n                    })\n                })*/\n            }).catch(() => {\n                that.$message({\n                    type: 'warning',\n                    message: '删除失败'\n                })\n            })\n        },\n    },\n}\n",{"version":3,"sources":["uploadList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"uploadList.vue","sourceRoot":"src/components/upload","sourcesContent":["<template>\r\n    <div class=\"upload-list\">\r\n        <tableList ref=\"uploadTable\"\r\n            :getDataWay=\"getDataWay\"\r\n            :columns=\"listColumns\"\r\n            index\r\n            >\r\n            <el-table-column label=\"操作\"\r\n                             align=\"center\"\r\n                             header-align=\"center\" slot=\"opts\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-button-group>\r\n                        <el-tooltip class=\"item\" :hide-after=\"300\" effect=\"dark\" content=\"预览\" placement=\"top\">\r\n                            <el-button size=\"mini\" icon=\"el-icon-view\" plain\r\n                                       @click=\"handlePreview(scope.$index, scope.row)\" class=\"edit\"></el-button>\r\n                        </el-tooltip>\r\n                        <el-tooltip class=\"item\" :hide-after=\"300\" effect=\"dark\" content=\"下载\" placement=\"top\">\r\n                            <el-button size=\"mini\" icon=\"el-icon-download\" plain\r\n                                       @click=\"handleDownload(scope.$index, scope.row)\" class=\"download\"></el-button>\r\n                        </el-tooltip>\r\n                        <el-tooltip class=\"item\" :hide-after=\"300\" effect=\"dark\" content=\"下移\" placement=\"top\">\r\n                            <el-button size=\"mini\" icon=\"el-icon-d-arrow-right tras-icon\" plain\r\n                                       @click=\"handleDown(scope.$index, scope.row)\" class=\"down\"></el-button>\r\n                        </el-tooltip>\r\n                        <el-tooltip class=\"item\" :hide-after=\"300\" effect=\"dark\" content=\"上移\" placement=\"top\">\r\n                            <el-button size=\"mini\" icon=\"el-icon-d-arrow-left tras-icon\" plain\r\n                                       @click=\"handleUp(scope.$index, scope.row)\" class=\"up\"></el-button>\r\n                        </el-tooltip>\r\n                        <el-tooltip class=\"item\" :hide-after=\"300\" effect=\"dark\" content=\"删除\" placement=\"top\">\r\n                            <el-button size=\"mini\" icon=\"el-icon-delete-solid\" plain\r\n                                       @click=\"handleDelete(scope.$index, scope.row)\" class=\"del\"></el-button>\r\n                        </el-tooltip>\r\n                    </el-button-group>\r\n                </template>\r\n            </el-table-column>\r\n        </tableList>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n    import TableList from \"../grid/TableList\";\r\n    export default {\r\n        name: \"uploadList\",\r\n        components:{\r\n            tableList:TableList,\r\n        },\r\n        props:{\r\n            listColumns:{\r\n                type:Array,\r\n                required:true\r\n            },\r\n            listData:{\r\n                type:Array,\r\n                required:true\r\n            },\r\n            listType:{\r\n                type:String,\r\n                required:true\r\n            }\r\n        },\r\n        data(){\r\n            return{\r\n                getDataWay:{\r\n                    dataType:'data',\r\n                    data:this.listData\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            handlePreview(index, row){\r\n                console.log(row);\r\n                if(this.listType==='picture') {\r\n                    let url = this.$api.upload.reqUrl+ this.$api.upload.downloadByMd5Path+\"?md5Path=\"+row.md5Path+ \"&access_token=\"+localStorage.getItem(\"Authorization\").split(\" \")[1]\r\n                    // let url = this.$api.upload.reqUrl + this.$api.upload.preview + '?md5Path='+row.md5Path;\r\n                    window.open(url, '_blank')\r\n                    this.$message({\r\n                        type:\"success\",\r\n                        message:'图片预览'\r\n                    })\r\n                }else {\r\n                    if (row.md5Path) {\r\n                        let fileExt = row.fileSrcName.split('.')[1];\r\n                        let that = this;\r\n                        console.log(fileExt)\r\n                        let url = that.$api.upload.reqUrl + that.$api.upload.preview + '?md5Path='\r\n                        if (fileExt === 'pdf') {\r\n                            let param = row.md5Path + '&waterMark=1&forceRefresh=1&access_token=' + localStorage.getItem('access_token')\r\n                            window.open(url + param, '_blank')\r\n                        } else {//非pdf文件预览还在解决\r\n                            that.$message({\r\n                                type: 'info',\r\n                                message: '预览失败，目前仅支持pdf类型文件预览！'\r\n                            })\r\n                        }\r\n                    } else {\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: '预览失败，请检查文件路径！'\r\n                        })\r\n                    }\r\n                }\r\n            },\r\n            handleDownload(index, row) {//上传文件可下载\r\n                console.log(index);\r\n                console.log(row);\r\n                let that = this;\r\n                this.$$download(row).then(()=>{\r\n                    that.$message({\r\n                        type: 'success',\r\n                        message: '下载成功！'\r\n                    })\r\n                }).catch((err)=>{\r\n                    that.$message({\r\n                        type: 'info',\r\n                        message: '下载失败！'\r\n                    })\r\n                })\r\n            },\r\n            handleDown(index, row) {//下移\r\n                console.log(index);\r\n                console.log(row);\r\n                if(index===this.getDataWay.data.length-1){\r\n                    this.$message({\r\n                        type:\"warning\",\r\n                        duration:1000,\r\n                        message:\"已经到底了\"\r\n                    })\r\n                    return false\r\n                }else {\r\n                    let item = this.getDataWay.data[index];\r\n                    this.$set(this.getDataWay.data,index,this.getDataWay.data[index+1])\r\n                    this.$set(this.getDataWay.data,index+1,item)\r\n                }\r\n                console.log(this.getDataWay.data);\r\n            },\r\n            handleUp(index, row) {//上移\r\n                console.log(index);\r\n                console.log(row);\r\n                if(index===0){\r\n                    this.$message({\r\n                        type:\"warning\",\r\n                        duration:1000,\r\n                        message:\"已经到顶了\"\r\n                    })\r\n                    return false\r\n                }else {\r\n                    let item = this.getDataWay.data[index];\r\n                    this.$set(this.getDataWay.data,index,this.getDataWay.data[index-1])\r\n                    this.$set(this.getDataWay.data,index-1,item)\r\n                }\r\n                console.log(this.getDataWay.data);\r\n            },\r\n            handleDelete(index, row) {//删除\r\n                console.log(index);\r\n                console.log(row);\r\n                let that = this;\r\n                this.$confirm(`确定移除该文件？`, '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    console.log('------',row);\r\n                    that.$$deleteUpLoad({md5Path:row.md5Path}).then((res)=>{\r\n                        that.$message({\r\n                            type: 'success',\r\n                            message: '删除成功'\r\n                        });\r\n                        that.getDataWay.data.splice(index, 1);\r\n                    }).catch((err)=>{\r\n                        that.$message({\r\n                            type: 'warning',\r\n                            message: '删除失败'\r\n                        })\r\n                    })\r\n                    /*that.$axios({\r\n                        method: 'post',\r\n                        url: this.$api.wjglApi.Zh001deleteFile,\r\n                        data: {\r\n                            id: row.id,\r\n                        }\r\n                    }).then(function (response) {\r\n                        console.log(response,'//////');\r\n                        that.$message({\r\n                            type: 'warning',\r\n                            message: '删除成功'\r\n                        });\r\n                        that.tableData.splice(index, 1);\r\n                        if(!!row.filePath){\r\n                            that.$emit('delFile',row)\r\n                        }\r\n                    }).catch(function (error) {\r\n                        console.log('>>>>>>>');\r\n                        that.$message({\r\n                            type: 'warning',\r\n                            message: '删除失败'\r\n                        })\r\n                    })*/\r\n                }).catch(() => {\r\n                    that.$message({\r\n                        type: 'warning',\r\n                        message: '删除失败'\r\n                    })\r\n                })\r\n            },\r\n        },\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}