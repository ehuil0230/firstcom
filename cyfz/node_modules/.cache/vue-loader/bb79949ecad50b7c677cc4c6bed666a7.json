{"remainingRequest":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vueWorkspace\\cyfz\\src\\views\\hygl\\gzzlgl\\Instructions.vue?vue&type=style&index=0&id=9c8dbf2a&scoped=true&lang=css&","dependencies":[{"path":"D:\\vueWorkspace\\cyfz\\src\\views\\hygl\\gzzlgl\\Instructions.vue","mtime":1571637100574},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vueWorkspace\\cyfz\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.move-right {\n    margin-right: -200px;\n}\n\n.rc {\n    width: 820px;\n}\n.task-form-item{\n    margin-left: 200px;\n    display: inline-block;\n}\n\n.task-btn-item {\n    padding-top: 0;\n    display: inline-block;\n    margin-left: 0px;\n    vertical-align: middle;\n    float: left;\n    padding-left: 10px;\n}\n",{"version":3,"sources":["Instructions.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsVA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Instructions.vue","sourceRoot":"src/views/hygl/gzzlgl","sourcesContent":["<template>\r\n    <div style=\"margin: 20px\">\r\n            <div style=\"display: inline-block;margin-bottom: 20px\">\r\n                <el-button @click=\"dialogFormVisible=true\" size=\"small\" type=\"primary\">新建</el-button>\r\n                <el-button size=\"small\" style=\"margin-left: 10px\" type=\"primary\" @click=\"reload\">刷新</el-button>\r\n            </div>\r\n            <div  style=\"display: inline-block;float: right;\">\r\n                    <el-input size=\"small\" v-model=\"searchParams.title\" placeholder=\"请输入标题名称\"\r\n                              prefix-icon=\"el-icon-search\" @input=\"search\">\r\n                    </el-input>\r\n            </div>\r\n\r\n        <!--指令添加弹出框-->\r\n        <!--<el-dialog\r\n                :close-on-click-modal=\"false\"\r\n                :visible.sync=\"dialogFormVisible\"\r\n                title=\"新建指令\"\r\n                v-dialogDrag\r\n                width=\"1050px\"\r\n                @close=\"formClose\"\r\n                :destroy-on-close=\"true\"\r\n        >\r\n            <div style=\"width:100%;\">\r\n                <el-form :inline=\"true\" :model=\"form\" :rules=\"rules\" label-width=\"120px\" ref=\"form\" size=\"medium\">\r\n                    <el-form-item label=\"接收人\" prop=\"recievers\">\r\n                       <el-select v-model=\"form.recievers\" multiple placeholder=\"请选择\" :disabled=\"uploadVisible\">\r\n                            <el-option\r\n                                    v-for=\"item in reciverList\"\r\n                                    :key=\"item.uuid\"\r\n                                    :label=\"item.realName\"\r\n                                    :value=\"item.uuid\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"指令标题\" prop=\"title\">\r\n                        <el-input :disabled=\"uploadVisible\" class=\"rc\" type=\"text\" v-model=\"form.title\" maxlength=\"30\"\r\n                                  show-word-limit></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"指令内容\" prop=\"content\">\r\n                        <el-input :disabled=\"uploadVisible\" :rows=\"5\" class=\"rc\" type=\"textarea\" v-model=\"form.content\"\r\n                                  maxlength=\"1000\"\r\n                                  show-word-limit></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"附件\" prop=\"cyUpload\">\r\n                        <cyUpload ref=\"upload\" :file-num=\"fileNum\" :auto-up=\"true\"></cyUpload>\r\n                    </el-form-item>\r\n                    <el-form-item style=\"width: 100%;text-align: center\">\r\n                        <el-button v-if=\"showTip\" @click=\"submitForm('form')\" size=\"medium \" type=\"primary\">保存</el-button>\r\n                        <el-button @click=\"dialogFormVisible = false\" size=\"medium \">取消</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </div>\r\n        </el-dialog>-->\r\n        <tableList :columns=\"columns\"\r\n                   :getDataWay=\"getDataWay\"\r\n                   :pagination=\"pagination\"\r\n                   ref=\"table\"\r\n                   index\r\n        >\r\n<!--            <el-table-column label=\"\" slot=\"icon\" width=\"35px\">-->\r\n            <el-table-column label=\"\" slot=\"icon\" width=\"44px\">\r\n                <template slot-scope=\"scope\">\r\n                    <!--<el-button type=\"info\" icon=\"el-icon-message\" circle v-if=\"scope.row.state==0\" size=\"mini\"></el-button>\r\n                    <el-button type=\"success\" icon=\"el-icon-check\" circle v-else size=\"mini\" style=\"background-color: #3a8ee6\"></el-button>-->\r\n                    <!-- Example of  Example of envelope-o Example of envelope-open Example of envelope-open-o-->\r\n                    <i class=\"fa fa-envelope-o\" style=\"font-size: 20px\" v-if=\"scope.row.state==0\"></i>\r\n                    <i class=\"fa fa-envelope-open-o\" style=\"font-size: 20px\" v-else></i>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"标题\" slot=\"title\" show-overflow-tooltip>\r\n                <template slot-scope=\"scope\">\r\n                    <el-link :underline=\"false\" @click.stop=\"selectGg(scope.row)\" class=\"a-link\">\r\n                        {{scope.row.title}}\r\n                    </el-link>\r\n                </template>\r\n            </el-table-column>\r\n        </tableList>\r\n        <!--指令详情弹出框-->\r\n       <!-- <el-dialog\r\n                :close-on-click-modal=\"false\"\r\n                :visible.sync=\"dialogFormVisibleInfo\"\r\n                title=\"指令详情\"\r\n                v-dialogDrag\r\n                width=\"1050px\"\r\n        >\r\n            <div style=\"width:100%;\">\r\n                <el-form :inline=\"true\" :model=\"formInfo\" :rules=\"rules\" label-width=\"120px\" ref=\"form\" size=\"medium\">\r\n                    <el-form-item label=\"发送人\" prop=\"senderName\">\r\n                        <el-input :disabled=\"true\" class=\"rc\" type=\"name\" v-model=\"formInfo.senderName\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"指令标题\" prop=\"title\">\r\n                        <el-input :disabled=\"true\" class=\"rc\" type=\"text\" v-model=\"formInfo.title\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"指令内容\" prop=\"content\">\r\n                        <el-input :disabled=\"true\" :rows=\"10\" class=\"rc\" type=\"textarea\"\r\n                                  v-model=\"formInfo.content\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"附件\">\r\n                        <p class=\"fj_list\" v-for=\"item in fileList\" @click=\"downl(item)\"><i class=\"el-icon-tickets\"></i>{{item.name}}\r\n                        </p>\r\n                    </el-form-item>\r\n                    <el-form-item style=\"width: 100%;text-align: center\">\r\n                        <el-button @click=\"dialogFormVisibleInfo = false\" size=\"medium \">关闭</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </div>\r\n        </el-dialog>-->\r\n        <zl-dialog v-if=\"dialogFormVisible\" :dialogFormVisible.sync=\"dialogFormVisible\" :form=\"form\" @afterNew=\"afterNew\"></zl-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import tableList from '@/components/grid/TableList.vue';\r\n    import zlDialog from \"./zlDialog\";\r\n\r\n\r\n    export default {\r\n        name: \"sendInstructions\",\r\n        components: {\r\n            zlDialog,\r\n            tableList\r\n        },\r\n        data() {\r\n            return {\r\n                showTip: true,\r\n                uploadVisible: false,\r\n                relatedId: '',\r\n                reciverList: [],\r\n                //新建弹出框\r\n                dialogFormVisible: false,\r\n                form: {\r\n                    //站内信代码\r\n                    MailDm: '002',\r\n                    //接收人ID\r\n                    recievers: [],\r\n                    //接收人姓名\r\n                    recieverNames: '',\r\n                    //接收标题\r\n                    title: '',\r\n                    //接收内容\r\n                    content: '',\r\n                    uuid:'',\r\n                    type:0\r\n                },\r\n                //搜索框中的数据\r\n                searchParams: {\r\n                    //标题\r\n                    title: '',\r\n                    //发送人\r\n                    user: ''\r\n                },\r\n                //数据接收\r\n                getDataWay: {\r\n                    dataType: \"url\",\r\n                    type: 'post',\r\n                    data: this.$api.hyglApi.querySendMeMail,\r\n                    param:{}\r\n                    //data: '/MailDetailCtrl/querySendMeMailDetail',\r\n                }, // 通过url方式\r\n                //分页\r\n                pagination: {\r\n                    currentPage: 1,\r\n                    pageSize: 10,\r\n                    position: 'right',\r\n                    layout: 'total,prev, pager, next, jumper'\r\n                },\r\n                //tablelist表单的列名\r\n                columns: [\r\n                    {\r\n                        label: '读否',\r\n                        prop: 'icon',\r\n                        template:true,\r\n                        width: '10%',\r\n                    },\r\n                    {\r\n                        label: '发送人',\r\n                        prop: 'senderName',\r\n                        width: '15%',\r\n                    },\r\n                    {\r\n                        label: '标题',\r\n                        prop: 'title',\r\n                        template: true\r\n                    },\r\n                    {\r\n                        label: '发送部门',\r\n                        prop: 'sendOrgName',\r\n                        width: '15%',\r\n                    },\r\n                    {\r\n                        label: '发送时间',\r\n                        prop: 'createTime',\r\n                        width: '20%',\r\n                    },\r\n                ],\r\n            }\r\n        },\r\n        methods: {\r\n            afterNew(obj){\r\n                this.form = {\r\n                    //站内信代码\r\n                    MailDm: '002',\r\n                    //接收人ID\r\n                    recievers: [],\r\n                    //接收人姓名\r\n                    recieverNames: '',\r\n                    //接收标题\r\n                    title: '',\r\n                    //接收内容\r\n                    content: '',\r\n                    //传入uuid以此区分新建还是修改\r\n                    uuid:''\r\n                }\r\n                this.$refs.table.loadData();\r\n            },\r\n            reload(){\r\n                this.$refs.table.loadData();\r\n            },\r\n            search(){\r\n               /*  let that = this\r\n               let params={\r\n                    title:this.searchParams.title,\r\n                    user:this.searchParams.user\r\n                }\r\n                this.$refs.table.loadData(params);*/\r\n                /*this.$axios({\r\n                    method: 'post',\r\n                    url: this.$api.hyglApi.querySendMeMail,\r\n                    data: {\r\n                        title:this.searchParams.title,\r\n                        sender:this.searchParams.user\r\n                    }\r\n                }).then(function (res) {\r\n                    that.$refs.table.loadData();\r\n                })*/\r\n                this.$set(this.getDataWay.param,'title',this.searchParams.title);\r\n                this.$refs.table.loadData()\r\n\r\n            },\r\n\r\n            closeDialogFunc() {\r\n                this.dialogFormVisible = false;\r\n                this.relatedid = 'init'\r\n            },\r\n           /* //新建工作指令\r\n            submitForm(formName) {\r\n                let that = this;\r\n                let tempArr = [];\r\n                for (let item of that.form.recievers) {\r\n                    for (let temp of that.reciverList) {\r\n                        if (item === temp.uuid) {\r\n                            tempArr.push(temp.realName);\r\n                        }\r\n                    }\r\n                }\r\n                if (tempArr.length >= 2) {\r\n                    that.form.recieverNames = tempArr.join(\",\");\r\n                    that.form.recieverNames += \"...\"\r\n                } else {\r\n                    that.form.recieverNames = tempArr.join(\",\");\r\n                }\r\n                this.$refs[formName].validate((valid) => {\r\n                    if (valid) {\r\n                        //添加接口\r\n                        that.form.recievers = that.form.recievers.join(\",\");\r\n                        let req = that.form;\r\n                        this.$axios({\r\n                            method: 'post',\r\n                            url: this.$api.hyglApi.saveMail,\r\n                            data: req\r\n                        }).then(function (res) {\r\n                            console.log(res)\r\n                            if (res.result === 1) {\r\n                                let fileList = that.$refs.upload.fileList;\r\n                                if (fileList.length > 0) {\r\n                                    /!*保存成功，关联附件列表*!/\r\n                                    console.log(that.$refs.upload.fileList);\r\n                                    let MD5Paths = [], fileNames = [];\r\n                                    fileList.forEach((item) => {\r\n                                        MD5Paths.push(item.url);\r\n                                        fileNames.push(item.name);\r\n                                    })\r\n                                    let param = {\r\n                                        \"relatedid\": res.info.uuid,\r\n                                        \"MD5Path\": MD5Paths.join(','),\r\n                                        \"fileName\": fileNames.join(',')\r\n                                    }\r\n                                    that.$$insertFileInfoBatch(param).then((resdata) => {\r\n                                        that.$message({\r\n                                            message: '新增成功',\r\n                                            type: 'success'\r\n                                        });\r\n                                        that.dialogFormVisible = false;\r\n                                    }).catch(function (err) {\r\n                                        that.$message({\r\n                                            message: '关联附件列表失败',\r\n                                            type: 'warning'\r\n                                        });\r\n                                        that.dialogFormVisible = false;\r\n                                    })\r\n                                } else {\r\n                                    that.$message({\r\n                                        message: '新增成功',\r\n                                        type: 'success'\r\n                                    });\r\n                                    that.dialogFormVisible = false;\r\n                                }\r\n                            }\r\n                        })\r\n                    } else {\r\n                        console.log('error submit!!');\r\n                        return false;\r\n                    }\r\n                });\r\n            },*/\r\n            //点击标题弹出详情框\r\n            selectGg(data) {\r\n                this.dialogFormVisible = true;\r\n                this.form.uuid = data.uuid;\r\n                this.form.recieverNames = data.senderName;\r\n                this.form.title = data.title;\r\n                this.form.content = data.content;\r\n                this.form.type = 1;\r\n\r\n            },\r\n        },\r\n        created() {\r\n\r\n            var that = this\r\n            this.$$request({\r\n                url: this.$api.homeApi.getLoginUserList,\r\n                data: {}\r\n            }).then(function (res) {\r\n                that.reciverList = res.info;\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n    .move-right {\r\n        margin-right: -200px;\r\n    }\r\n\r\n    .rc {\r\n        width: 820px;\r\n    }\r\n    .task-form-item{\r\n        margin-left: 200px;\r\n        display: inline-block;\r\n    }\r\n\r\n    .task-btn-item {\r\n        padding-top: 0;\r\n        display: inline-block;\r\n        margin-left: 0px;\r\n        vertical-align: middle;\r\n        float: left;\r\n        padding-left: 10px;\r\n    }\r\n</style>\r\n"]}]}